<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xavier Escribà Montagut">
<meta name="author" content="Juan R. Gonzàlez">

<title>dsExposome: Use case 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="use_case_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="use_case_1_files/libs/quarto-html/quarto.js"></script>
<script src="use_case_1_files/libs/quarto-html/popper.min.js"></script>
<script src="use_case_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="use_case_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="use_case_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="use_case_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="use_case_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="use_case_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="use_case_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="use_case_1_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="use_case_1_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="use_case_1_files/libs/datatables-binding-0.24/datatables.js"></script>
<script src="use_case_1_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="use_case_1_files/libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="use_case_1_files/libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="use_case_1_files/libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="use_case_1_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="use_case_1_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#description" id="toc-description" class="nav-link active" data-scroll-target="#description">Description</a></li>
  <li><a href="#connecting-to-the-opal-server" id="toc-connecting-to-the-opal-server" class="nav-link" data-scroll-target="#connecting-to-the-opal-server">Connecting to the Opal server</a></li>
  <li><a href="#exploration-of-the-data" id="toc-exploration-of-the-data" class="nav-link" data-scroll-target="#exploration-of-the-data">Exploration of the data</a></li>
  <li><a href="#exposome-wide-association-study" id="toc-exposome-wide-association-study" class="nav-link" data-scroll-target="#exposome-wide-association-study">Exposome Wide Association Study</a></li>
  <li><a href="#visualization-of-results" id="toc-visualization-of-results" class="nav-link" data-scroll-target="#visualization-of-results">Visualization of results</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">dsExposome: Use case 1</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Xavier Escribà Montagut 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            ISGlobal
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Juan R. Gonzàlez 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            ISGlobal
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-1_761c7b3f517bcab872b0c0d2f3c76817">
<style type="text/css">
p, figcaption {
  text-align: justify !important;
}
</style>
</div>
<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description">Description</h2>
<p>In the first use case, we will demonstrate the capabilities of the dsExposome package and DataSHIELD infrastructure for performing a pooled Exposome-Wide Association Study (ExWAS) on synthetic exposome data. The data consists of 88 exposures and 109 individuals, divided into two cohorts of 51 and 58 individuals respectively, stored on two different Opal servers. Figure 1 illustrates the infrastructure of this use case, showcasing the decentralization of the data and the secure nature of the analysis performed through DataSHIELD. By utilizing dsExposome and DataSHIELD, we aim to demonstrate the potential of this approach for large-scale exposome studies, advancing our understanding of the relationship between environmental exposures and human health. Performing a pooled analysis with the dsExposome package on the DataSHIELD infrastructure means that the results we receive are the same as if we had all the data together in the same dataset. This provides a significant advantage over traditional meta-analysis studies, where results are often limited by the heterogeneity of the data or the inability to pool data from multiple sources. This offers the ability to analyze the combined data from two different opal servers as if it were one dataset, providing a robust and secure approach to exposome analysis.</p>
<div id="fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/fig1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption"><strong>Figure 1</strong> Architecture of the Exposome Analysis Use Case, which consists of two different Opal servers storing the synthetic exposome data of 88 exposures and 109 individuals, divided into two cohorts of 51 and 58 individuals, respectively. The data is securely stored on each server and is available to the researcher through non-disclosive aggregated results.</figcaption><p></p>
</figure>
</div>
</section>
<section id="connecting-to-the-opal-server" class="level2">
<h2 class="anchored" data-anchor-id="connecting-to-the-opal-server">Connecting to the Opal server</h2>
<p>To begin our analysis, we begin by connecting to the analysis servers. On them, there is all the data that we will need in this use case.</p>
<p>On the following chunk, we will perform the connection and load the exposome data that we will be using.</p>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-2_4b240a686c4e60c7d71e9d89335d3c6f">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSOpal)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsBaseClient)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsExposomeClient)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>builder <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">newDSLoginBuilder</span>()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">"cohort1"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">url =</span> <span class="st">"https://opal-demo.obiba.org/"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">"dsuser"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">password =</span> <span class="st">"P@ssw0rd"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">profile =</span> <span class="st">"exposome"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">"EXPOSOME.exposome_use_case_1_a"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">"cohort2"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">url =</span> <span class="st">"https://opal-demo.obiba.org/"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">"dsuser"</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">password =</span> <span class="st">"P@ssw0rd"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">profile =</span> <span class="st">"exposome"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">"EXPOSOME.exposome_use_case_1_b"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>logindata <span class="ot">&lt;-</span> builder<span class="sc">$</span><span class="fu">build</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>connections <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">datashield.login</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">logins =</span> logindata, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">assign =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">symbol =</span> <span class="st">"exposome_resource"</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.assign.expr</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">conns =</span> connections, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">symbol =</span> <span class="st">"exposome_set"</span>, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">expr =</span> <span class="st">"as.resource.object(exposome_resource)"</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploration-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="exploration-of-the-data">Exploration of the data</h2>
<p>With the connection performed and the data loaded, we can begin by performing some simple exploration of the data. In this use case we will check for the percentage of missings by exposure. Also, we will retrieve the names of the exposures families. Finally, we will check the phenotype variables available on the dataset.</p>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-3_19112a29531b8bbe5597e1e8db6f872f">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>missings <span class="ot">&lt;-</span> <span class="fu">ds.tableMissings</span>(<span class="st">"exposome_set"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.plotMissings</span>(missings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$pooled</code></pre>
</div>
<div class="cell-output-display">
<p><img src="use_case_1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.familyNames</span>(<span class="st">"exposome_set"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cohort1
 [1] "Air Pollutants"    "Metals"            "PBDEs"            
 [4] "Organochlorines"   "Bisphenol A"       "Water Pollutants" 
 [7] "Built Environment" "Cotinine"          "Home Environment" 
[10] "Phthalates"        "Noise"             "PFOAs"            
[13] "Temperature"      

$cohort2
 [1] "Air Pollutants"    "Metals"            "PBDEs"            
 [4] "Organochlorines"   "Bisphenol A"       "Water Pollutants" 
 [7] "Built Environment" "Cotinine"          "Home Environment" 
[10] "Phthalates"        "Noise"             "PFOAs"            
[13] "Temperature"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.exposome_variables</span>(<span class="st">"exposome_set"</span>, <span class="at">target =</span> <span class="st">"phenotypes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cohort1
[1] "whistling_chest" "flu"             "rhinitis"        "wheezing"       
[5] "birthdate"       "sex"             "age"             "cbmi"           
[9] "blood_pre"      

$cohort2
[1] "whistling_chest" "flu"             "rhinitis"        "wheezing"       
[5] "birthdate"       "sex"             "age"             "cbmi"           
[9] "blood_pre"      </code></pre>
</div>
</div>
</section>
<section id="exposome-wide-association-study" class="level2">
<h2 class="anchored" data-anchor-id="exposome-wide-association-study">Exposome Wide Association Study</h2>
<p>And finally, we will perform the ExWAS presented on the manuscript. We will check for the association of the <code>flu</code> health condition to the exposures of the families <code>Air Pollutants</code> and <code>Metals</code>.</p>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-4_bca551d2e99e67008c343c953cdbc523">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">ds.exwas</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"flu ~ 1"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Set =</span> <span class="st">"exposome_set"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pooled"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposures_family =</span> <span class="fu">c</span>(<span class="st">"Air Pollutants"</span>, <span class="st">"Metals"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tef =</span> <span class="cn">FALSE</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-5_a1096f7abf83faccfb1cd13337ff6ecd">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res<span class="sc">$</span>exwas_results <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">'pt'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-0d61f45fb756ed033f19" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0d61f45fb756ed033f19">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37"],["AbsPM25","As","Benzene","Cd","Co","Cs","Cu","Hg","Mo","Ni","NO","NO2","NOx","Pb","PM10","PM10Cu","PM10Fe","PM10K","PM10Ni","PM10S","PM10SI","PM10V","PM10Zn","PM25","PM25CU","PM25FE","PM25K","PM25Ni","PM25S","PM25Sl","PM25V","PM25Zn","PMcoarse","Sb","Se","Tl","Zn"],["Air Pollutants","Metals","Air Pollutants","Metals","Metals","Metals","Metals","Metals","Metals","Metals","Air Pollutants","Air Pollutants","Air Pollutants","Metals","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Air Pollutants","Metals","Metals","Metals","Metals"],[-4.61,2.02,0.74,-0.95,-1.94,0.54,2.1,-0.31,0.16,-1.01,-1.96,-1.2,-1.71,0.89,-1.05,-3.26,-4.33,-4.93,4.97,3.29,-0.99,0.67,0.92,-6.37,-2.86,-0.89,-2.83,4.72,3.97,-1.28,0.21,0.66,-0.88,1.38,4.27,0.43,2.08],[-12.24,0.44,-4.04,-3.51,-5.27,-3.43,-1.06,-2.24,-4.22,-3.08,-6.1,-6.58,-6.44,-1.72,-12.73,-7.41,-11.39,-16.75,-3.15,-13.12,-12.11,-1.13,-6.96,-19.72,-8.22,-5.23,-12.52,-3.26,-15.89,-18.86,-2.22,-2.72,-8.39,-0.62,-1.22,-1.47,-0.55],[3.03,3.6,5.53,1.61,1.4,4.5,5.26,1.63,4.54,1.06,2.18,4.18,3.02,3.5,10.63,0.89,2.74,6.89,13.1,19.69,10.12,2.47,8.8,6.98,2.51,3.44,6.86,12.7,23.83,16.3,2.63,4.05,6.63,3.39,9.76,2.34,4.7],[0.24,0.01,0.76,0.47,0.26,0.79,0.19,0.76,0.94,0.34,0.35,0.66,0.48,0.5,0.86,0.12,0.23,0.41,0.23,0.69,0.86,0.47,0.82,0.35,0.3,0.69,0.57,0.25,0.7,0.89,0.87,0.7,0.82,0.18,0.13,0.66,0.12]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>exposure<\/th>\n      <th>family<\/th>\n      <th>coefficient<\/th>\n      <th>minE<\/th>\n      <th>maxE<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"pt","columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="visualization-of-results" class="level2">
<h2 class="anchored" data-anchor-id="visualization-of-results">Visualization of results</h2>
<p>Finally we visualize the results of the ExWAS.</p>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-6_bc410924524068a82faa2f6f9ae79403">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.plotExwas</span>(res, <span class="at">thld_pvalue =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="use_case_1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Following good practices, once we have finished using the Opal server for our purposes, we logout of it to free the computational resources.</p>
<div class="cell" data-hash="use_case_1_cache/html/unnamed-chunk-7_29e18f10dc859e5e89e4b6e1fd2764e9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.logout</span>(connections)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>